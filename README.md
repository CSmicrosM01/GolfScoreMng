# 松本杯 ゴルフスコア管理Webアプリ

## 概要

年間のゴルフスコアを管理するWebアプリケーションです。S3静的ホスティングに対応し、Lambda関数URL経由で複数端末間のデータ自動同期が可能です。

## 作成日

2025年12月31日

## 作成工数

| 工程 | 所要時間（概算） |
|------|-----------------|
| 要件確認・エクセル分析 | 5分 |
| プロジェクト設計 | 5分 |
| HTML作成 | 10分 |
| CSS作成 | 15分 |
| JavaScript作成 | 20分 |
| データ変換（Excel→JSON） | 5分 |
| 修正対応 | 10分 |
| ドキュメント作成 | 5分 |
| 追加修正（レスポンシブ対応等） | 15分 |
| **合計** | **約90分** |

## プロンプト内容

### 初回プロンプト

```
年間のゴルフスコアを管理するWebアプリを作成したい。S3に静的ホスティングでDBは使用しない方式としたい。

現在は下記のエクセルで運用しているのでその運用内容から適切な画面構成としたい。
Downloads\2025松本杯.xlsx

要望としては
・ログイン時にユーザを選択（松本、正本、渡邉、近藤、比企、内藤で固定）
・ハンディキャップを適用したスコアと、適用しないスコアの両方を表示したい
・下記のルールで実施しているので、平均ベスト、ベストスコア、パター平均ベスト、ホールインワン達成者、イーグル達成者を確認できるようにしたい

　[開催・参加条件]
・ラウンド参加人数が３名以上であること
・ラウンドに３回以上参加していること

[各賞]
優勝　：翌年の○○杯に名前が付く、トロフィー授与
準優勝：６位からラウンドの昼食代を奢ってもらう ※
３位　：５位からラウンドの昼食代を奢ってもらう ※
４位　：何もなし
５位　：３位のラウンドの昼食代を奢る ※
６位　：準優勝のラウンドの昼食代を奢る ※
※：食事付いていないプランで全額

ベストスコア賞
：参加者全員から1,000円集めて6,000円ぐらいのゴルフボールをプレゼント（受賞者が好きなゴルフボールを選べる）

平均パット数ランキング１位
：参加者全員から1,000円集めて6,000円ぐらいのゴルフボールをプレゼント（受賞者が好きなゴルフボールを選べる）
※パット数はグリーン上でパットした数
※一度グリーンを出てもリセットされない
※OKもパット数に含める
```

### 修正プロンプト1

```
・ログイン時の選択はそのままでよいですが、それ以外はすべてさん付けで名前を表示してください
・スコア入力は各ユーザが入力できるようにしたいです。後ほど修正も行う可能性もあります。
・ハンディキャップ適用有無はラジオボタンで切り替えられるようにしたいです
```

### 修正プロンプト2

```
1/1にプレイオフを行うことになったので、年度は入力画面に指定できるようにしてほしいです。
```

### 修正プロンプト3

```
・スマホでの入力がほとんどなので、レスポンシブ対応もお願いします。
・スコア一覧は「さん」なしでよいです
・スコア一括入力とスコア入力は分割したいです。一括入力は現状のスコア入力画面、スコア入力はログインしたユーザのみが入力できる画面
・操作方法を画面に追加してください
```

## ファイル構成

```
golf-score-app/
├── index.html      # メインHTMLファイル
├── styles.css      # スタイルシート
├── app.js          # アプリケーションロジック
├── data.js         # 初期データ（エクセルから変換）
├── data.json       # 共有データファイル（S3/Lambda用）
├── lambda/
│   └── index.mjs   # Lambda関数コード
├── README.md       # このドキュメント
├── DEPLOY.md       # S3デプロイ手順
└── AWS_SETUP.md    # Lambda関数URL設定手順
```

## 機能一覧

### 1. ログイン画面
- 6名のユーザー（松本、正本、渡邉、近藤、比企、内藤）から選択
- ログインボタンは「さん」なし、それ以外の画面では「さん」付け

### 2. ダッシュボード
- ベストスコア賞（3回以上参加者のベスト）
- パット平均ベスト賞
- 開催情報（総開催回数、有効参加者数）
- ログインユーザーの個人成績
- **総合ランキング**（ハンディ適用、3回以上参加者のみ）
- ホールインワン・イーグル達成者リスト

### 3. ランキング
- **総合順位**（平均スコア）
  - ラジオボタンでハンディキャップ適用/非適用を切替
  - 1位〜6位の賞バッジ表示
- **ベストスコアランキング**（上位10件）
- **パット平均ランキング**
- ※すべて3回以上参加者のみ対象

### 4. スコア一覧
- 全ラウンドのスコア・パット数表示（ユーザー名は「さん」なし）
- ユーザー/コースでフィルタリング可能
- 参加人数3名未満のラウンドは薄く表示（無効扱い）
- 各ラウンドに「編集」ボタン

### 5. スコア入力（個人用）
- ログインユーザーが自分のスコアのみを簡単に入力
- 最近の自分のスコア履歴を表示
- 同じ日付・コースのラウンドがあれば自動で追加

### 6. 一括入力（幹事用）
- 全員のスコアをまとめて入力
- 既存ラウンドの編集・削除
- ホールインワン/イーグル達成記録
- データエクスポート/インポート（JSON形式）

### 7. 各賞・ルール
- 開催・参加条件の説明
- 各順位の賞内容
- パット数ルールの説明
- ハンディキャップ設定
- **カップ名設定**（年度ごとに変更可能）

### 8. 操作方法
- 基本的な使い方
- 各画面の説明
- よくある質問

## データ仕様

### localStorageキー
`golfScoreApp`

### データ構造
```json
{
  "years": {
    "2025": {
      "rounds": [
        {
          "roundNumber": 1,
          "date": "2025-01-01",
          "course": "箱根くらかけ",
          "scores": {
            "松本": { "score": 88, "putt": 34 },
            "渡邉": { "score": 106, "putt": 39 },
            ...
          }
        }
      ],
      "holeInOnes": [],
      "eagles": []
    }
  },
  "handicaps": {
    "松本": 0,
    "正本": 0,
    ...
  },
  "cupNames": {
    "2025": "松本杯"
  }
}
```

## データ同期方式

### 方式1: Lambda関数URL経由（推奨）

スコアを保存すると自動的にS3上の`data.json`に同期されます。

**設定方法**: [AWS_SETUP.md](AWS_SETUP.md) を参照

**仕組み**:
```
[端末A] ──保存──> Lambda関数URL ──> S3 data.json
                                        ↓
[端末B] ←──取得── Lambda関数URL <────────┘
```

**app.jsの設定**:
```javascript
const LAMBDA_FUNCTION_URL = 'https://xxxxxxxxxx.lambda-url.ap-northeast-1.on.aws/';
const USE_LAMBDA_SYNC = true;
```

### 方式2: 手動アップロード（シンプル）

スコア保存後、`data.json`をダウンロードしてS3に手動アップロードします。

**app.jsの設定**:
```javascript
const USE_LAMBDA_SYNC = false;
const USE_S3_SYNC = true;
```

## S3静的ホスティング設定

詳細は [DEPLOY.md](DEPLOY.md) を参照

### アップロードファイル
- index.html
- styles.css
- app.js
- data.js
- data.json（共有データ）

### バケット設定
1. 静的ウェブサイトホスティングを有効化
2. インデックスドキュメント: `index.html`
3. バケットポリシーでパブリックアクセスを許可

### 注意事項
- Lambda同期を有効にすると、複数端末間でデータが自動同期されます
- 同時編集を避けるため、スコア入力担当者を決めることを推奨します

## 技術仕様

- **HTML5**: セマンティックマークアップ
- **CSS3**: CSS Grid, Flexbox, CSS Variables, アニメーション, レスポンシブデザイン
- **JavaScript**: ES6+, localStorage API, Fetch API（非同期通信）
- **AWS**: S3（静的ホスティング）, Lambda関数URL（データ同期）
- **外部ライブラリ**: なし（Vanilla JS）
- **対応デバイス**: PC、タブレット、スマートフォン

## ルール実装詳細

### 有効ラウンド条件
- 参加人数が3名以上

### ランキング対象条件
- 有効ラウンドに3回以上参加

### ハンディキャップ
- スコアからハンディキャップを減算
- 各賞・ルールタブで設定可能

## 今後の拡張案

- [x] 年度選択機能の実装
- [x] レスポンシブデザイン（スマホ対応）
- [x] 個人スコア入力機能
- [x] 操作方法画面
- [x] Lambda関数URL経由のデータ自動同期
- [x] カップ名設定機能
- [x] ダッシュボードに総合ランキング表示
- [x] 同率順位対応
- [ ] グラフ表示（スコア推移など）
- [ ] コース別統計
- [ ] 印刷用レイアウト
- [ ] PWA対応（オフライン機能）
